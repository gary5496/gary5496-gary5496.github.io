<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en-US">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.5" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.5">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.5">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.5" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.5',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="Hexo, NexT" />


<meta property="og:type" content="website">
<meta property="og:title" content="Gary Guo">
<meta property="og:url" content="https://gary5496.github.io/index.html">
<meta property="og:site_name" content="Gary Guo">
<meta property="og:locale" content="en-US">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gary Guo">






  <link rel="canonical" href="https://gary5496.github.io/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>Gary Guo</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en-US">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Gary Guo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Learning never ends</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />Sitemap</a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />Search</a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gary5496.github.io/2018/06/lessons-learned-when-consuming-op-service-in-scp-cf-app/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gary Guo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gary Guo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/lessons-learned-when-consuming-op-service-in-scp-cf-app/" itemprop="url">Lessons Learned When Consuming On-Premise Service in SCP Cloud Foundry Application</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-19T14:17:18+08:00">2018-06-19</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/SAP/" itemprop="url" rel="index"><span itemprop="name">SAP</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>I am trying to follow the below links to build a SCP (SAP Cloud Platform) Cloud Foundry application which is using XSUAA (User account and authentication) service,  SCP Connectivity service and SCC (SAP Cloud Connector) to consume On-Premise OData service. The below lessons are learned during the prototype.</p>
<p><a href="https://blogs.sap.com/2017/07/09/how-to-use-the-sap-cloud-platform-connectivity-and-the-cloud-connector-in-the-cloud-foundry-environment-part-1/" target="_blank" rel="noopener">https://blogs.sap.com/2017/07/09/how-to-use-the-sap-cloud-platform-connectivity-and-the-cloud-connector-in-the-cloud-foundry-environment-part-1/</a><br><a href="https://blogs.sap.com/2017/07/13/part-2-how-to-use-the-sap-cloud-platform-connectivity-and-the-cloud-connector-in-the-cloud-foundry-environment/" target="_blank" rel="noopener">https://blogs.sap.com/2017/07/13/part-2-how-to-use-the-sap-cloud-platform-connectivity-and-the-cloud-connector-in-the-cloud-foundry-environment/</a></p>
<h3 id="Maven-installation"><a href="#Maven-installation" class="headerlink" title="Maven installation"></a>Maven installation</h3><ol>
<li>Install JDK and set environment variable <code>JAVA_HOME</code></li>
<li>Download Apache Maven and unzip the file</li>
<li>Add environment variable <code>M2_HOME</code> and <code>MAVEN_HOME</code></li>
<li>Update environment variable <code>PATH</code> for Maven bin folder</li>
<li>Run command <code>mvn -version</code> to verify the installation</li>
</ol>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://www.mkyong.com/maven/how-to-install-maven-in-windows/" target="_blank" rel="noopener">https://www.mkyong.com/maven/how-to-install-maven-in-windows/</a><br><a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/download.cgi</a></p>
<hr>
<h3 id="Maven-eclipse-plugin-installation"><a href="#Maven-eclipse-plugin-installation" class="headerlink" title="Maven eclipse plugin installation"></a>Maven eclipse plugin installation</h3><p>Please check the below reference links for details. Update site to install Maven plugin in Eclipse:<br><a href="http://download.eclipse.org/technology/m2e/releases/" target="_blank" rel="noopener">http://download.eclipse.org/technology/m2e/releases/</a></p>
<h3 id="Reference-1"><a href="#Reference-1" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://stackoverflow.com/questions/8620127/maven-in-eclipse-step-by-step-installation" target="_blank" rel="noopener">https://stackoverflow.com/questions/8620127/maven-in-eclipse-step-by-step-installation</a><br><a href="http://toolsqa.com/java/maven/how-to-install-maven-eclipse-ide/" target="_blank" rel="noopener">http://toolsqa.com/java/maven/how-to-install-maven-eclipse-ide/</a></p>
<hr>
<h3 id="Error"><a href="#Error" class="headerlink" title="Error:"></a>Error:</h3><p>Failed to read artifact descriptor for org.apache.maven.plugins:maven-resources-plugin:jar:2.6<br>Could not transfer artifact org.springframework.boot:spring-boot-starter-parent:pom:1.5.7.RELEASE from/to Central (<a href="http://repo1.maven.org/maven2)" target="_blank" rel="noopener">http://repo1.maven.org/maven2)</a>: Connection refused: connect and ‘parent.relativePath’ points at wrong local POM</p>
<h3 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution:"></a>Resolution:</h3><ol>
<li>Run the below command in Linux:<br><code>find ~/.m2  -name &quot;*.lastUpdated&quot; -exec grep -q &quot;Could not transfer&quot; {} \; -print -exec rm {} \;</code><br>Run the below commands in Windows<br><code>cd %userprofile%\.m2\repository</code><br><code>for /r %i in (*.lastUpdated) do del %i</code><br>Then right click on your project in eclipse and choose <code>Maven-&gt;Update Project ...</code>, make sure “Update Dependencies” is checked in the resulting dialog and click OK.</li>
<li>You can always try <code>mvn -U clean install</code><br>-U Forces a check for updated releases and snapshots on remote repositories</li>
<li>There may be different versions of Maven running between command prompt and Eclipse. Check the Maven installations and Maven user settings in <code>Eclipse -&gt; Windows -&gt; Preferences</code></li>
</ol>
<h3 id="Reference-2"><a href="#Reference-2" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://stackoverflow.com/questions/5074063/maven-error-failure-to-transfer" target="_blank" rel="noopener">https://stackoverflow.com/questions/5074063/maven-error-failure-to-transfer</a></p>
<hr>
<h3 id="Error-1"><a href="#Error-1" class="headerlink" title="Error:"></a>Error:</h3><p>No compiler is provided in this environment. Perhaps you are running on a JRE rather than a JDK?</p>
<h3 id="Resolution-1"><a href="#Resolution-1" class="headerlink" title="Resolution:"></a>Resolution:</h3><ol>
<li>Install JDK instead of JRE</li>
<li>Set environment variables <code>JAVA_HOME, classpath, PATH</code> to link them to JDK, instead of JRE</li>
<li>Check the settings <code>Windows -&gt; Preferences -&gt; Java -&gt;Installed JREs</code> in Eclipse. Make sure there is at least one JDK there. Link the Run configuration of Maven build to the JDK</li>
</ol>
<h3 id="Reference-3"><a href="#Reference-3" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://stackoverflow.com/questions/19655184/no-compiler-is-provided-in-this-environment-perhaps-you-are-running-on-a-jre-ra" target="_blank" rel="noopener">https://stackoverflow.com/questions/19655184/no-compiler-is-provided-in-this-environment-perhaps-you-are-running-on-a-jre-ra</a></p>
<hr>
<h3 id="Error-2"><a href="#Error-2" class="headerlink" title="Error:"></a>Error:</h3><p>The following artifacts could not be resolved: com.sap.xs2.security:java-container-security-api:jar:0.26.4, com.sap.xs2.security:java-container-security:jar:0.26.4: Failure to find com.sap.xs2.security:java-container-security-api:jar:0.26.4 in <a href="https://repo.maven.apache.org/maven2" target="_blank" rel="noopener">https://repo.maven.apache.org/maven2</a> was cached in the local repository, resolution will not be reattempted until the update interval of central has elapsed or updates are forced</p>
<h3 id="Resolution-2"><a href="#Resolution-2" class="headerlink" title="Resolution:"></a>Resolution:</h3><p>Install XS Security libs to your local Maven repository:</p>
<ol>
<li>The first step is to get some additional Java libs from Service Marketplace.<br>Download additional XS security libs from service marketplace:<a href="https://launchpad.support.sap.com/#/softwarecenter/search/XS_JAVA" target="_blank" rel="noopener">https://launchpad.support.sap.com/#/softwarecenter/search/XS_JAVA</a> </li>
<li>Unzip the file</li>
<li>Install XS Security Libs to your local maven repo using:<br><code>cd &lt;destLocation&gt;</code><br><code>mvn clean install</code></li>
</ol>
<h3 id="Reference-4"><a href="#Reference-4" class="headerlink" title="Reference:"></a>Reference:</h3><p><a href="https://blogs.sap.com/2017/07/18/step-7-with-sap-s4hana-cloud-sdk-secure-your-application-on-sap-cloud-platform-cloudfoundry/" target="_blank" rel="noopener">https://blogs.sap.com/2017/07/18/step-7-with-sap-s4hana-cloud-sdk-secure-your-application-on-sap-cloud-platform-cloudfoundry/</a></p>
<hr>
<h3 id="Error-3"><a href="#Error-3" class="headerlink" title="Error:"></a>Error:</h3><p>The import org.json cannot be resolved<br>The import org.apache.commons.io cannot be resolved</p>
<h3 id="Resolution-3"><a href="#Resolution-3" class="headerlink" title="Resolution:"></a>Resolution:</h3><ol>
<li><p>Download the ZIP file from the below URL and extract it to get the Jar. </p>
</li>
<li><p>Add the Jar to your build path. To Add this Jar to your build path <code>Right click the Project &gt; Build Path &gt; Configure build path &gt; Select Libraries tab &gt; Click Add External Libraries &gt; Select the Jar file downloaded</code></p>
</li>
</ol>
<p><a href="http://www.java2s.com/Code/JarDownload/java/java-json.jar.zip" target="_blank" rel="noopener">http://www.java2s.com/Code/JarDownload/java/java-json.jar.zip</a><br><a href="http://commons.apache.org/proper/commons-io/download_io.cgi" target="_blank" rel="noopener">http://commons.apache.org/proper/commons-io/download_io.cgi</a></p>
<h3 id="Reference-5"><a href="#Reference-5" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://stackoverflow.com/questions/8997598/importing-json-into-an-eclipse-project" target="_blank" rel="noopener">https://stackoverflow.com/questions/8997598/importing-json-into-an-eclipse-project</a></p>
<hr>
<h3 id="Error-4"><a href="#Error-4" class="headerlink" title="Error"></a>Error</h3><p>package json.java does not exist<br>package org.apache.commons.io does not exist</p>
<h3 id="Resolution-4"><a href="#Resolution-4" class="headerlink" title="Resolution"></a>Resolution</h3><ol>
<li>Run the below Maven command to install the Maven repository<br><code>mvn install:install-file -Dfile=java-json.jar -DgroupId=json.java -DartifactId=java-json -Dversion=1.0 -Dpackaging=jar</code><br><code>mvn install:install-file -Dfile=commons-io-2.6.jar -DgroupId=commons-io -DartifactId=commons-io -Dversion=2.6 -Dpackaging=jar</code></li>
<li>Add the below dependencies to the pom.xml file<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>json.java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Reference-6"><a href="#Reference-6" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://stackoverflow.com/questions/41779195/maven-compilation-error-even-if-dependency-path-is-correct" target="_blank" rel="noopener">https://stackoverflow.com/questions/41779195/maven-compilation-error-even-if-dependency-path-is-correct</a></p>
<hr>
<h3 id="Error-5"><a href="#Error-5" class="headerlink" title="Error"></a>Error</h3><p>Cannot instantiate the type XSTokenRequest</p>
<h3 id="Resolution-5"><a href="#Resolution-5" class="headerlink" title="Resolution"></a>Resolution</h3><ol>
<li>Run the below command to install the Jar file to local Maven repository<br><code>mvn install:install-file -Dfile=java-container-security-api-0.26.4.jar -DgroupId=com.sap.xs2.security -DartifactId=java-container-security-api -Dversion=0.26.4 -Dpackaging=jar</code><br><code>mvn install:install-file -Dfile=java-container-security-0.26.4.jar -DgroupId=com.sap.xs2.security -DartifactId=java-container-security -Dversion=0.26.4 -Dpackaging=jar</code></li>
<li>Change the pom.xml with the below:<pre><code>&lt;dependency&gt;
      &lt;groupId&gt;com.sap.xs2.security&lt;/groupId&gt;
      &lt;artifactId&gt;java-container-security-api&lt;/artifactId&gt;
      &lt;version&gt;0.26.4&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.sap.xs2.security&lt;/groupId&gt;
    &lt;artifactId&gt;java-container-security&lt;/artifactId&gt;
     &lt;version&gt;0.26.4&lt;/version&gt; 
&lt;/dependency&gt;
</code></pre></li>
<li>Run <code>Maven update</code> for the project</li>
<li>Check the build path for the Java file to see if multiple libraries are used</li>
</ol>
<hr>
<h3 id="Error-6"><a href="#Error-6" class="headerlink" title="Error"></a>Error</h3><p>The import javax.servlet can’t be resolved [duplicate]</p>
<h3 id="Resolution-6"><a href="#Resolution-6" class="headerlink" title="Resolution"></a>Resolution</h3><p>You need to add the Servlet API to your classpath. In Tomcat 6.0, this is in a JAR called servlet-api.jar in Tomcat’s lib folder. You can either add a reference to that JAR to the project’s classpath, or put a copy of the JAR in your Eclipse project and add it to the classpath from there.</p>
<h3 id="Reference-7"><a href="#Reference-7" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://stackoverflow.com/questions/4119448/the-import-javax-servlet-cant-be-resolved" target="_blank" rel="noopener">https://stackoverflow.com/questions/4119448/the-import-javax-servlet-cant-be-resolved</a></p>
<hr>
<h3 id="Error-7"><a href="#Error-7" class="headerlink" title="Error:"></a>Error:</h3><p>Unable to extract request URI: URI must contain a host<br>http://&lt;virtual_host&gt;:80/sap/opu/odata/sap/&lt;odata_service&gt;//$metadata</p>
<h3 id="Resolution-7"><a href="#Resolution-7" class="headerlink" title="Resolution:"></a>Resolution:</h3><p>Update the SCC (SAP Cloud Connector) and SCP destination to make sure underscore is not used in the hostname</p>
<hr>
<h3 id="How-to-change-the-font-size-in-Eclipse-editor"><a href="#How-to-change-the-font-size-in-Eclipse-editor" class="headerlink" title="How to change the font size in Eclipse editor"></a>How to change the font size in Eclipse editor</h3><p>Windows -&gt; Preferences -&gt; General -&gt; Appearance -&gt; Color and Fonts -&gt; Basic -&gt; Text Font -&gt; Edit -&gt; Apply</p>
<hr>
<h3 id="How-to-search-for-a-string-in-a-project-in-Eclipse"><a href="#How-to-search-for-a-string-in-a-project-in-Eclipse" class="headerlink" title="How to search for a string in a project in Eclipse"></a>How to search for a string in a project in Eclipse</h3><p>Ctrl + H</p>
<hr>
<h3 id="How-to-upload-a-project-over-20M-to-SCP-CF-environment"><a href="#How-to-upload-a-project-over-20M-to-SCP-CF-environment" class="headerlink" title="How to upload a project over 20M to SCP CF environment"></a>How to upload a project over 20M to SCP CF environment</h3><p>Use Eclipse Cloud Foundry plugin</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gary5496.github.io/2018/04/encoding-issue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gary Guo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gary Guo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/encoding-issue/" itemprop="url">Encoding in SAP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-12T12:30:23+08:00">2018-04-12</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/SAP/" itemprop="url" rel="index"><span itemprop="name">SAP</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Since different applications are using different encodings to process data, there may be encoding issue when the source application and destination application are using different encodings.</p>
<h3 id="ECC-Encoding"><a href="#ECC-Encoding" class="headerlink" title="ECC Encoding"></a>ECC Encoding</h3><ul>
<li>SAP ECC is saving data in database with Unicode encoding. You can check if your SAP application server is using Little Indian (4103) or Big Indian (4102) via <code>t-code I18N -&gt; I18N Customizing -&gt; I18N System Configuration -&gt; Display Current NLS config -&gt; &quot;Code Page of Application Server&quot;</code>. </li>
<li>When SAP ECC is sending a XML file to PI, UTF-8 encoding (4110) will be used.</li>
<li>When SAP ECC is writing a flat file to application server folder, the encoding will depend on the ABAP statement <code>OPEN DATASET ... ENCODING ...</code>. If <code>ENCODING DEFAULT</code> or <code>ENCODING UTF-8</code> is used, UTF-8 will be used.</li>
<li>When SAP ECC is using file port to write an IDOC flat file, the encoding will be UTF-8 if the <code>Unicode format</code> checkbox is selected in port (t-code WE21).</li>
<li>When SAP ECC is using file port to write an IDOC flat file, the encoding will be using the relevant code page if <code>Unicode format</code> is not selected and <code>Char. Set</code> is specified in port (t-code WE21).</li>
<li>When SAP ECC is using file port to write an IDOC flat file, if <code>Unicode format</code> and <code>Char. Set</code> are not specified, the encoding will be using the same encoding as ABAP statement <code>ENCODING NON-UNICODE</code>. In an Unicode SAP system, the encoding in the table <code>TCP0C</code> by platform, language and country will be used. In the case of Linux, English, and US, the encoding will be ISO-8859-1 (1100). You can use ABAP statements <code>SET COUNTRY</code> and <code>SET LOCALE LANGUAGE</code> to change the language and country in a ABAP session.</li>
</ul>
<h3 id="PI-Encoding"><a href="#PI-Encoding" class="headerlink" title="PI Encoding"></a>PI Encoding</h3><ul>
<li>PI sender file channel will use the specified file encoding to read the file, if file type is set to <code>Text</code> instead of <code>Binary</code>. </li>
<li>You can convert a flat file to XML file via adapter module <code>AF_Modules/MessageTransformBean</code>, and specify the encoding of the XML file by setting the parameter <code>Transform.ContentType</code> to <code>text/plain;charset=utf-8</code>.</li>
<li>You can convert the encoding of an output file from UTF-8 to ISO-8859-1 via adapter module <code>AF_Modules/TextCodepageConversionBean</code> with parameter <code>Conversion.charset</code> equal to <code>iso-8859-1</code>.</li>
</ul>
<h3 id="Utilities"><a href="#Utilities" class="headerlink" title="Utilities"></a>Utilities</h3><p>You can check the hex code and UTF-8 bytes for one character in this <a href="http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=0421&amp;mode=hex" target="_blank" rel="noopener">site</a>. Please note:</p>
<ul>
<li>The hex code is using Unicode big indian, such as <code>0421</code> for <code>CYRILLIC CAPITAL LETTER ES</code> - <code>C</code>.</li>
<li>The UTF-8 bytes should contain space if there are multiple bytes for one character, such as <code>D0 A1</code>.</li>
<li>In some cases, <code>UTF-8 bytes as Latin-1 characters bytes</code> will be showing the same invalid characters as destination application, if source application is using <code>UTF-8</code> encoding, and the destination application is using encoding like <code>ISO-8859-1</code> to process data.<br>You can use Notepad++ to open a file with different encodings, and you can also convert it to use another encoding.<br>You can use some application like <code>WinHex</code> or <code>Hex_edit</code> to see the hex code for one text file.</li>
</ul>
<h3 id="Common-Encoding-Code-Pages"><a href="#Common-Encoding-Code-Pages" class="headerlink" title="Common Encoding/Code Pages"></a>Common Encoding/Code Pages</h3><ul>
<li>1100 for ISO-8859-1, which is similar to WINDOWS-1252/ANSI</li>
<li>4110 for UTF-8, the optional BOM (Byte Order Mask) will be EFBBBF for UTF-8</li>
<li>4102 for UTF-16be</li>
<li>4103 for UTF-16le</li>
<li>8400 for GB2312</li>
</ul>
<h3 id="One-encoding-issue-in-my-work"><a href="#One-encoding-issue-in-my-work" class="headerlink" title="One encoding issue in my work"></a>One encoding issue in my work</h3><ul>
<li>Issue: Below is one encoding issue I came accross with in my work. In SAP ECC system, the character is showing as <code>C</code>, but in destination application, the character is showing as <code>Ð ¡</code>, and can not be recoginzed.</li>
<li>Analysis: The special character <code>CYRILLIC CAPITAL LETTER ES</code> which is showing exactly the same as <code>LATIN LETTER C</code> is used in SAP ECC. In debugging mode, we will see that the hex code is <code>2104</code> since SAP ECC system is using Unicode little indian. In the <a href="http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=0421&amp;mode=hex" target="_blank" rel="noopener">site</a>, we checked with the hex code <code>0421</code> which is Unicode big indian, and we can find that the UTF-8 bytes for this character is <code>D0 A1</code>, and <code>UTF-8 bytes as Latin-1 characters bytes</code> is showing as <code>Ð ¡</code>.</li>
</ul>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a href="http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=0421&amp;mode=hex" target="_blank" rel="noopener">Check hex code and UTF-8 bytes for one character</a><br><a href="https://launchpad.support.sap.com/#/notes/552464" target="_blank" rel="noopener">SAP note 552464 - What is Big Endian / Little Endian? What Endian do I have?</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gary5496.github.io/2018/03/sap-status-functions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gary Guo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gary Guo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/sap-status-functions/" itemprop="url">ABAP development for Status Management in SAP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-28T15:57:53+08:00">2018-03-28</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/SAP/" itemprop="url" rel="index"><span itemprop="name">SAP</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Below you will find some objects which is useful when you are performing ABAP development for status management in SAP.</p>
<h3 id="Function-Modules"><a href="#Function-Modules" class="headerlink" title="Function Modules"></a>Function Modules</h3><ol>
<li><code>STATUS_READ</code>: With this function, you can get the system status and user status internal codes, such as <code>I0001</code>, <code>E0001</code>.</li>
<li><code>STATUS_TEXT_EDIT</code>: With this function, you can get the external status code <code>REL</code> <code>APPR</code> for one object. In an update transaction, if you set the input parameter <code>BYPASS_BUFFER</code> to <code>X</code>, it will get the old status code from database. If you set the input parameter <code>BYPASS_BUFFER</code> to blank, it will get the new status code after the change.</li>
<li><code>STATUS_CHANGE_INTERN</code>: With this function, you can update the system status.</li>
<li><code>STATUS_CHANGE_EXTERN</code>: With this function, you can update the user status.</li>
<li><code>STATUS_CHANGES_GET</code>: With this function, you can get the status changes in the current update transaction.</li>
</ol>
<h3 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h3><ol>
<li><code>JSTO</code>: Status object information. It contains the status profile and object category for one object.</li>
<li><code>JEST</code>: Individual Object Status. It contains the object status information. Field <code>INACT</code> indicates whether the status is active or not.</li>
<li><code>TJ02T</code>: System status texts. It contains the external status code and description for one system status, which is <code>INNNN</code>.</li>
<li><code>TJ30T</code>: Texts for User Status. It contains the external status code and description for one user status, which is <code>ENNNN</code>. </li>
<li><code>JCDS</code>: Change Documents for system/user status. It contains the change documents for status management.</li>
</ol>
<h3 id="T-codes"><a href="#T-codes" class="headerlink" title="T-codes"></a>T-codes</h3><ol>
<li><code>BS23</code>: Display system status</li>
<li><code>BS03</code>: Display status profile (user status)</li>
</ol>
<h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h3><ul>
<li>You can use <code>Authorization key</code> to control the authorization to update user status. If the auth key is assigned to one user status in status profile, the authorization with auth object <code>B_USERSTAT</code> and auth key should be assigned to the user, so that one is able to update the user status. </li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gary5496.github.io/2018/03/javascript-await-async/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gary Guo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gary Guo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/javascript-await-async/" itemprop="url">Async and Await Keywords in JavaScript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-27T14:31:49+08:00">2018-03-27</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Async-Await"><a href="#Async-Await" class="headerlink" title="Async/Await"></a>Async/Await</h3><p>To better understand the behavior of async and await keywords in JavaScript, I have written the below code and check the result.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</span><br><span class="line"><span class="comment">// Convert fs.readFile into Promise version of same    </span></span><br><span class="line"><span class="keyword">const</span> readFile = util.promisify(fs.readFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncReadfile1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The await async function to read file 1 is called"</span>);</span><br><span class="line">  <span class="keyword">const</span> text = <span class="keyword">await</span> readFile(<span class="string">"C:/Download/129.xps"</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'The file 1 contains: '</span> + text.length + <span class="string">' bytes'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncReadfile2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The await async function to read file 2 is called"</span>);</span><br><span class="line">  <span class="keyword">const</span> text =<span class="keyword">await</span> readFile(<span class="string">"C:/Download/141.xps"</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'The file 2 contains: '</span> + text.length + <span class="string">' bytes'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncMain</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">await</span> asyncReadfile1();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Processing between reading 2 files"</span>);  </span><br><span class="line">  <span class="keyword">await</span> asyncReadfile2();</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"successful"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Start processing..."</span>);</span><br><span class="line">asyncMain().then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The async main function is called "</span> + result); </span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Go to the next statement after the async main function"</span>);</span><br></pre></td></tr></table></figure>
<p>Result:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ node app.js</span><br><span class="line"><span class="keyword">Start</span> processing...</span><br><span class="line">The await async <span class="keyword">function</span> <span class="keyword">to</span> <span class="keyword">read</span> <span class="keyword">file</span> <span class="number">1</span> <span class="keyword">is</span> called</span><br><span class="line"><span class="keyword">Go</span> <span class="keyword">to</span> the <span class="keyword">next</span> <span class="keyword">statement</span> <span class="keyword">after</span> the async <span class="keyword">main</span> <span class="keyword">function</span></span><br><span class="line">The <span class="keyword">file</span> <span class="number">1</span> contains: <span class="number">251610</span> <span class="keyword">bytes</span></span><br><span class="line">Processing <span class="keyword">between</span> reading <span class="number">2</span> files</span><br><span class="line">The await async <span class="keyword">function</span> <span class="keyword">to</span> <span class="keyword">read</span> <span class="keyword">file</span> <span class="number">2</span> <span class="keyword">is</span> called</span><br><span class="line">The <span class="keyword">file</span> <span class="number">2</span> contains: <span class="number">549337</span> <span class="keyword">bytes</span></span><br><span class="line">The async <span class="keyword">main</span> <span class="keyword">function</span> <span class="keyword">is</span> called successful</span><br></pre></td></tr></table></figure>
<p>Here are the processing steps for the above example.</p>
<ol>
<li>The runtime engine will call main function <code>asyncMain</code>, which will in turn call the first <code>await</code> async function <code>asyncReadfile1</code> , which will output console log <code>The await async function to read file 1 is called</code></li>
<li>When the function <code>asyncReadfile1</code> runs to the statement <code>const text = await readFile(&quot;C:/Download/129.xps&quot;);</code>, the Promise object returned from <code>readFile</code> is <em>not resolved</em> yet, so the execution stack will go back to upper function <code>asyncMain</code>. In the main function, the Promise object returned from <code>asyncReadfile1</code> is <em>not resolved</em> yet, so the executation stack will go back to upper level. Therefore, the next console log is <code>Go to the next statement after the async main function</code>.</li>
<li>When the sync processing logic in the upmost level is completed, the call stack goes back to deepest unresolved Promise function <code>asyncReadfile1</code>. In the async function <code>asyncReadfile1</code>, the statement <code>const text = await readFile(&quot;C:/Download/129.xps&quot;);</code> is completed and the Promise object is <em>resolved</em>, so it will continue with the next statement, and the next console log is <code>The file 1 contains: 251610 bytes</code>. After the console log, the Promise object of async function <code>asyncReadfile1</code> is <em>resolved</em>.</li>
<li>Since the promise object of async function <code>asyncReadfile1</code> is <em>resolved</em>, the main function will continue with next statement, which will output console log <code>Processing between reading 2 files</code>.</li>
<li>In the next statement of main function, async function <code>asyncReadfile2</code> wil be called, and the console log will be <code>The await async function to read file 2 is called</code> and <code>The file 2 contains: 549337 bytes</code></li>
<li>After the return statement of main function, the Promise object of the main function is <em>resolved</em>, so the callback function in <code>Promise.prototype.then</code> method will be executed to output console log <code>The async main function is called successful</code></li>
</ol>
<h3 id="Understanding-for-async-await"><a href="#Understanding-for-async-await" class="headerlink" title="Understanding for async/await:"></a>Understanding for async/await:</h3><ol>
<li>When the Promise object returned from <code>await</code> child function is <em>not resolved</em> yet, the execution stack will go back to parent function.</li>
<li>When the Promise object returned from <code>await</code> child function is <em>resolved</em>, the execution stack will continue with next statement in the current function.</li>
<li>When the sync processing logic in the upmost level is completed, the call stack goes back to deepest unresolved Promise function.</li>
</ol>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>To achieve the same functionality with Promise object, we would need to more complex code with nested <code>Promise.prototype.then</code> method.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);</span><br><span class="line"><span class="comment">// Convert fs.readFile into Promise version of same    </span></span><br><span class="line"><span class="keyword">const</span> readFile = util.promisify(fs.readFile);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncReadfile1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The await async function to read file 1 is called"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123; </span><br><span class="line">    readFile(<span class="string">"C:/Download/129.xps"</span>).then( <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'The file 1 contains: '</span> + text.length + <span class="string">' bytes'</span>);</span><br><span class="line">      resolve();</span><br><span class="line">    &#125; );</span><br><span class="line">  &#125; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncReadfile2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The await async function to read file 2 is called"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123; </span><br><span class="line">    readFile(<span class="string">"C:/Download/141.xps"</span>).then( <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'The file 2 contains: '</span> + text.length + <span class="string">' bytes'</span>);</span><br><span class="line">      resolve();</span><br><span class="line">    &#125; );</span><br><span class="line">  &#125; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncMain</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123; </span><br><span class="line">     asyncReadfile1().then( <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"Processing between reading 2 files"</span>);</span><br><span class="line">      asyncReadfile2().then( <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">"successful"</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Start processing..."</span>);</span><br><span class="line">asyncMain().then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"The async main function is called "</span> + result); </span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"Go to the next statement after the async main function"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Understanding-for-Promise"><a href="#Understanding-for-Promise" class="headerlink" title="Understanding for Promise"></a>Understanding for Promise</h3><ol>
<li><p>The resolved immediately Promise object will be effective in next <em>Event loop</em>, instead of current <em>Event loop</em>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'three'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// one</span></span><br><span class="line"><span class="comment">// two</span></span><br><span class="line"><span class="comment">// three</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>The <code>Promise.prototype.then</code> method will return another Promise object, which is not the original Promise object.</p>
</li>
<li>The new Promise object will be executed immediately after creation.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"New Promise object"</span>);</span><br><span class="line">    resolve();</span><br><span class="line">  &#125;).then( <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Callback method"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"After creating new Promise object"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// New Promise object</span></span><br><span class="line"><span class="comment">// After creating new Promise object</span></span><br><span class="line"><span class="comment">// Callback method</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://es6.ruanyifeng.com/#docs/promise#%E5%BA%94%E7%94%A8" target="_blank" rel="noopener">Promise object</a><br><a href="http://es6.ruanyifeng.com/?search=await&amp;x=0&amp;y=0#docs/async" target="_blank" rel="noopener">async function</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gary5496.github.io/2018/03/sap-enhance-vendor-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gary Guo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gary Guo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/sap-enhance-vendor-code/" itemprop="url">Enhance ABAP Code provided by Vendor in SAP</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-23T11:49:43+08:00">2018-03-23</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ABAP/" itemprop="url" rel="index"><span itemprop="name">ABAP</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>In SAP, sometimes we may need to add an enhancement implementation for an implicit enhancement spot of Vendor provided ABAP code. In that case, when you are trying to enhance the vendor code, you may receive an error message <code>Object &lt;object_type&gt; &lt;object_name&gt; cannot be enhanced; software component Unknown cannot be enhanced</code>.</p>
<h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>After the analysis, we find that in the function <code>TR_GET_DLVUNIT_CHANGEABILITY</code>, it will check table <code>CVERS</code> and <code>DLV_SYSTC</code> to see if the software component is changeable or not. If not, the error message will display. The software component is assigned to the package (development class) of the ABAP code.</p>
<p>To fix the issue, we tried to find a t-code or program to update table entries in <code>CVERS</code> and <code>DLV_SYSTC</code> to set the changeable flag to <em>Yes</em> for the software component, but with no luck.</p>
<p>Later, we tried to update the software component for the package, and below is the solution.</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>Run t-code <code>SE03</code>, and choose <code>Administration</code> -&gt; <code>Display/Change Namespaces</code>. Switch to change mode, double click on the namespace <code>/&lt;vendor_ns&gt;/</code> of the vendor package, change <code>Namespace role</code> to <code>C: Recipient</code> and save the entry.</p>
<p>Run t-code <code>SE80</code>, choose <code>Package</code>, input the package name, double click on the package, switch to change mode, change <code>Software Component</code> to <code>HOME</code>, and save the package.</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Gary Guo</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">19</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet" title="Markdown Cheatsheet" target="_blank">Markdown Cheatsheet</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://jsfiddle.net/tw09jte9/7/" title="JSFiddle" target="_blank">JSFiddle</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000" title="JavaScript - Liao XueFeng" target="_blank">JavaScript - Liao XueFeng</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" title="Git - Liao XueFeng" target="_blank">Git - Liao XueFeng</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ruanyifeng.com/blog/archives.html" title="Blog - Ruan YiFeng" target="_blank">Blog - Ruan YiFeng</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gary Guo</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.5</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="Total Visitors">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="Total Views">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.5"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.5"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.5"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.5"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.5"></script>



  



	





  





  










  



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

</body>
</html>
